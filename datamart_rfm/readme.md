# Создание витрины RFM

Построение витрины RFM, согласно заданным требованиям.

## Требования:

1. Построить витрину для RFM-анализа.
2. Глубина витрины должна включать всебя данные за 2022 год
3. Данные для витрины необходимо взять в схеме production саму витрину необходимо разместить в схеме analysis.
4. Витрина должна содержать следующие поля:
	* user_id
	* recency (число от 1 до 5)
	* frequency (число от 1 до 5)
	* monetary_value (число от 1 до 5)
5. Витрина должна называться dm_rfm_segments обновлять витрину не нужно.

### Пояснения по поводу RFM

RFM (от англ. Recency, Frequency, Monetary Value) — способ сегментации клиентов, при котором анализируют их лояльность: как часто, на какие суммы и когда в последний раз тот или иной клиент покупал что-то. На основе этого выбирают клиентские категории, на которые стоит направить маркетинговые усилия. 

Каждого клиента оценивают по трём факторам:

	* Recency (пер. «давность») — сколько времени прошло с момента последнего заказа.
	* Frequency (пер. «частота») — количество заказов.
	* Monetary Value (пер. «денежная ценность») — сумма затрат клиента.
	
## Стркутура репозитория

В репозитории размещены следующие скрипты:

	* [views.sql](views.sql) - создаёт представления в схеме analysis, необходимые для работы витрины в части модели RFM
	* [rfm_ddl.sql](rfm_ddl.sql) - создаёт таблицы в схеме analysis, необходимые для работы витрины в части модели RFM
	* [orders_view.sql](orders_view.sql) - создаёт представления для работы с заказами (в случае изменения работы таблицы orders на журналируемую версию)
	* [datamart_ddl.sql](datamart_ddl.sql) - создаёт таблицу с витриной в схеме analysis
	* [tmp_rfm_frequency.sql] (tmp_rfm_frequency.sql) - заполняет таблицу tmp_rfm_frequency
	* [tmp_rfm_monetary_value.sql] (tmp_rfm_monetary_value.sql) - заполняет таблицу tmp_rfm_monetary_value
	* [tmp_rfm_recency.sql] (tmp_rfm_recency.sql) - заполняет таблицу tmp_rfm_recency
	* [datamart_query.sql] (datamart_query.sql) - заполняет итоговую витрину